"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[10],{4793:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>t,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"arquitectura","title":"Arquitectura","description":"Visi\xf3n General","source":"@site/docs/arquitectura.md","sourceDirName":".","slug":"/arquitectura","permalink":"/Pasarela/docs/arquitectura","draft":false,"unlisted":false,"editUrl":"https://github.com/NeftaliYagua/Pasarela/tree/gh-pages/docs/arquitectura.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"tutorialSidebar","previous":{"title":"Ejemplos","permalink":"/Pasarela/docs/ejemplos"}}');var a=i(4848),l=i(8453);const r={sidebar_position:5},t="Arquitectura",o={},c=[{value:"Visi\xf3n General",id:"visi\xf3n-general",level:2},{value:"Componentes",id:"componentes",level:2},{value:"HAProxy (Balanceador)",id:"haproxy-balanceador",level:3},{value:"Pasarela (Gateway)",id:"pasarela-gateway",level:3},{value:"Redis",id:"redis",level:3},{value:"Kafka (Opcional)",id:"kafka-opcional",level:3},{value:"Escalabilidad",id:"escalabilidad",level:2},{value:"Horizontal",id:"horizontal",level:3},{value:"Vertical",id:"vertical",level:3},{value:"Alta Disponibilidad",id:"alta-disponibilidad",level:2},{value:"M\xe9tricas",id:"m\xe9tricas",level:2},{value:"Monitoreo",id:"monitoreo",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"arquitectura",children:"Arquitectura"})}),"\n",(0,a.jsx)(n.h2,{id:"visi\xf3n-general",children:"Visi\xf3n General"}),"\n",(0,a.jsx)(n.p,{children:"Pasarela v2.0 est\xe1 dise\xf1ada para alta disponibilidad y escalabilidad horizontal."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502    Clientes     \u2502\n                    \u2502 (Web, Mobile,   \u2502\n                    \u2502  IoT, etc.)     \u2502\n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                             \u2502\n                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502     HAProxy     \u2502\n                    \u2502   Puerto 5000   \u2502\n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                             \u2502\n        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n        \u2502                    \u2502                    \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Pasarela #1  \u2502   \u2502  Pasarela #2  \u2502   \u2502  Pasarela #N  \u2502\n\u2502   (Node.js)   \u2502   \u2502   (Node.js)   \u2502   \u2502   (Node.js)   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n        \u2502                   \u2502                   \u2502\n        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                            \u2502\n               \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n               \u2502                         \u2502\n        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2510          \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n        \u2502    Redis    \u2502          \u2502    Kafka    \u2502\n        \u2502  (Adapter)  \u2502          \u2502  (Eventos)  \u2502\n        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518          \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,a.jsx)(n.h2,{id:"componentes",children:"Componentes"}),"\n",(0,a.jsx)(n.h3,{id:"haproxy-balanceador",children:"HAProxy (Balanceador)"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Distribuye tr\xe1fico entre instancias"}),"\n",(0,a.jsx)(n.li,{children:"Sticky sessions por IP para WebSockets"}),"\n",(0,a.jsx)(n.li,{children:"Health checks autom\xe1ticos"}),"\n",(0,a.jsx)(n.li,{children:"Puerto: 5000"}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"pasarela-gateway",children:"Pasarela (Gateway)"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Servidor Node.js con Socket.io"}),"\n",(0,a.jsx)(n.li,{children:"Stateless (estado en Redis)"}),"\n",(0,a.jsx)(n.li,{children:"M\xe9tricas Prometheus"}),"\n",(0,a.jsx)(n.li,{children:"Puerto interno: 5000"}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"redis",children:"Redis"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Adapter de Socket.io para sincronizaci\xf3n"}),"\n",(0,a.jsx)(n.li,{children:"Almacenamiento de sesiones"}),"\n",(0,a.jsx)(n.li,{children:"Pub/Sub entre instancias"}),"\n",(0,a.jsx)(n.li,{children:"Puerto: 6379"}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"kafka-opcional",children:"Kafka (Opcional)"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Eventos as\xedncronos"}),"\n",(0,a.jsx)(n.li,{children:"Persistencia de mensajes"}),"\n",(0,a.jsx)(n.li,{children:"Integraci\xf3n con otros sistemas"}),"\n",(0,a.jsx)(n.li,{children:"Puerto: 9094"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"escalabilidad",children:"Escalabilidad"}),"\n",(0,a.jsx)(n.h3,{id:"horizontal",children:"Horizontal"}),"\n",(0,a.jsx)(n.p,{children:"A\xf1adir m\xe1s instancias de Pasarela:"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["Agregar servicio en ",(0,a.jsx)(n.code,{children:"docker-compose.yml"})]}),"\n",(0,a.jsxs)(n.li,{children:["Actualizar ",(0,a.jsx)(n.code,{children:"haproxy.cfg"})]}),"\n",(0,a.jsx)(n.li,{children:"Reiniciar"}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"vertical",children:"Vertical"}),"\n",(0,a.jsx)(n.p,{children:"Aumentar recursos de cada instancia seg\xfan necesidad."}),"\n",(0,a.jsx)(n.h2,{id:"alta-disponibilidad",children:"Alta Disponibilidad"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"M\xfaltiples instancias detr\xe1s de HAProxy"}),"\n",(0,a.jsx)(n.li,{children:"Redis Adapter sincroniza mensajes"}),"\n",(0,a.jsx)(n.li,{children:"Reconexi\xf3n autom\xe1tica de clientes"}),"\n",(0,a.jsx)(n.li,{children:"Health checks continuos"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"m\xe9tricas",children:"M\xe9tricas"}),"\n",(0,a.jsxs)(n.p,{children:["Disponibles en ",(0,a.jsx)(n.code,{children:"/metrics"})," (formato Prometheus):"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"pasarela_connections_total"})," - Conexiones activas"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"pasarela_messages_total"})," - Mensajes procesados"]}),"\n",(0,a.jsx)(n.li,{children:"M\xe9tricas de Node.js (CPU, memoria, event loop)"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"monitoreo",children:"Monitoreo"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Grafana"}),": Dashboards en ",(0,a.jsx)(n.a,{href:"http://localhost:3000",children:"http://localhost:3000"})]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Prometheus"}),": M\xe9tricas en ",(0,a.jsx)(n.a,{href:"http://localhost:9090",children:"http://localhost:9090"})]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Kafka UI"}),": Eventos en ",(0,a.jsx)(n.a,{href:"http://localhost:8080",children:"http://localhost:8080"})]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Redis Commander"}),": Cache en ",(0,a.jsx)(n.a,{href:"http://localhost:8081",children:"http://localhost:8081"})]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>t});var s=i(6540);const a={},l=s.createContext(a);function r(e){const n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);