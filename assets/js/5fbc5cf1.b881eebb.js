"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[624],{6439:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>t,metadata:()=>a,toc:()=>l});const a=JSON.parse('{"id":"api","title":"API de Eventos","description":"Conexi\xf3n","source":"@site/docs/api.md","sourceDirName":".","slug":"/api","permalink":"/docs/api","draft":false,"unlisted":false,"editUrl":"https://github.com/NeftaliYagua/tree/gh-pages/docs/api.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Instalaci\xf3n","permalink":"/docs/instalacion"},"next":{"title":"Ejemplos","permalink":"/docs/ejemplos"}}');var i=s(4848),r=s(8453);const t={sidebar_position:2},d="API de Eventos",c={},l=[{value:"Conexi\xf3n",id:"conexi\xf3n",level:2},{value:"Usando Socket.io directamente",id:"usando-socketio-directamente",level:3},{value:"Usando el conector helper",id:"usando-el-conector-helper",level:3},{value:"Eventos Cliente \u2192 Servidor",id:"eventos-cliente--servidor",level:2},{value:"identificar",id:"identificar",level:3},{value:"notificar",id:"notificar",level:3},{value:"pasarela",id:"pasarela",level:3},{value:"Destinos",id:"destinos",level:2},{value:"Eventos Servidor \u2192 Cliente",id:"eventos-servidor--cliente",level:2},{value:"notificar",id:"notificar-1",level:3},{value:"pasarela",id:"pasarela-1",level:3},{value:"Endpoints HTTP",id:"endpoints-http",level:2},{value:"Respuesta de /health",id:"respuesta-de-health",level:3},{value:"Conector Helper",id:"conector-helper",level:2}];function o(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"api-de-eventos",children:"API de Eventos"})}),"\n",(0,i.jsx)(n.h2,{id:"conexi\xf3n",children:"Conexi\xf3n"}),"\n",(0,i.jsx)(n.h3,{id:"usando-socketio-directamente",children:"Usando Socket.io directamente"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"const socket = io('http://localhost:5000/pasarela');\n"})}),"\n",(0,i.jsx)(n.h3,{id:"usando-el-conector-helper",children:"Usando el conector helper"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"const pasarela = new PasarelaConector('http://localhost:5000');\nawait pasarela.conectar();\n"})}),"\n",(0,i.jsx)(n.h2,{id:"eventos-cliente--servidor",children:"Eventos Cliente \u2192 Servidor"}),"\n",(0,i.jsx)(n.h3,{id:"identificar",children:"identificar"}),"\n",(0,i.jsx)(n.p,{children:"Asocia un identificador al socket actual."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"socket.emit('identificar', userId, (ok) => {\n  console.log(ok ? 'Identificado' : 'Error');\n});\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Par\xe1metros:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"userId"})," (string): Cualquier identificador \xfanico"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"callback"})," (function): Recibe ",(0,i.jsx)(n.code,{children:"true"})," si fue exitoso"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"El userId puede ser cualquier cosa:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"nickname"})," \u2192 Chats"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"firebase.uid"})," \u2192 Apps m\xf3viles"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"deviceId"})," \u2192 IoT"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"sessionId"})," \u2192 Web apps"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"orderId"})," \u2192 Sistemas de pedidos"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"notificar",children:"notificar"}),"\n",(0,i.jsx)(n.p,{children:"Env\xeda una notificaci\xf3n."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"socket.emit('notificar', {\n  destino: 'nosotros',\n  titulo: 'Alerta',\n  mensaje: 'Contenido de la notificaci\xf3n',\n  // ... cualquier dato adicional\n});\n"})}),"\n",(0,i.jsx)(n.h3,{id:"pasarela",children:"pasarela"}),"\n",(0,i.jsx)(n.p,{children:"Canal gen\xe9rico para cualquier tipo de mensaje."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"socket.emit('pasarela', {\n  destino: 'nosotros',\n  tipo: 'mi_tipo_de_evento',\n  // ... cualquier dato adicional\n});\n"})}),"\n",(0,i.jsx)(n.h2,{id:"destinos",children:"Destinos"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Destino"}),(0,i.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"yo"})}),(0,i.jsx)(n.td,{children:"Solo el emisor recibe el mensaje (default)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"ustedes"})}),(0,i.jsx)(n.td,{children:"Todos excepto el emisor"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"nosotros"})}),(0,i.jsx)(n.td,{children:"Todos incluyendo el emisor"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"eventos-servidor--cliente",children:"Eventos Servidor \u2192 Cliente"}),"\n",(0,i.jsx)(n.h3,{id:"notificar-1",children:"notificar"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"socket.on('notificar', (data) => {\n  console.log(data.titulo, data.mensaje);\n});\n"})}),"\n",(0,i.jsx)(n.h3,{id:"pasarela-1",children:"pasarela"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"socket.on('pasarela', (data) => {\n  switch(data.tipo) {\n    case 'chat_message':\n      // manejar mensaje de chat\n      break;\n    case 'order_update':\n      // manejar actualizaci\xf3n de pedido\n      break;\n  }\n});\n"})}),"\n",(0,i.jsx)(n.h2,{id:"endpoints-http",children:"Endpoints HTTP"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Endpoint"}),(0,i.jsx)(n.th,{children:"M\xe9todo"}),(0,i.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/"})}),(0,i.jsx)(n.td,{children:"GET"}),(0,i.jsx)(n.td,{children:"P\xe1gina de inicio"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/health"})}),(0,i.jsx)(n.td,{children:"GET"}),(0,i.jsx)(n.td,{children:"Health check (JSON)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/metrics"})}),(0,i.jsx)(n.td,{children:"GET"}),(0,i.jsx)(n.td,{children:"M\xe9tricas Prometheus"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"respuesta-de-health",children:"Respuesta de /health"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "status": "ok",\n  "instance": "1",\n  "connections": 42\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"conector-helper",children:"Conector Helper"}),"\n",(0,i.jsxs)(n.p,{children:["El archivo ",(0,i.jsx)(n.code,{children:"conector.js"})," proporciona una interfaz m\xe1s amigable:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"const pasarela = new PasarelaConector('http://localhost:5000');\n\n// Eventos\npasarela.on('connect', () => {});\npasarela.on('disconnect', () => {});\npasarela.on('pasarela', (data) => {});\npasarela.on('notificar', (data) => {});\n\n// M\xe9todos\nawait pasarela.conectar();\nawait pasarela.identificar(userId);\n\npasarela.enviar(data);           // destino en data\npasarela.enviarAMi(data);        // destino: yo\npasarela.enviarAOtros(data);     // destino: ustedes\npasarela.enviarATodos(data);     // destino: nosotros\n\npasarela.notificar(data);\npasarela.desconectar();\n"})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>d});var a=s(6540);const i={},r=a.createContext(i);function t(e){const n=a.useContext(r);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),a.createElement(r.Provider,{value:n},e.children)}}}]);